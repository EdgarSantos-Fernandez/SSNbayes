% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_func.R
\name{barst}
\alias{barst}
\title{Bayesian Autoregressive Spatio-Temporal model (BARST)}
\usage{
barst(
  formula = yobs ~ X1 + X2 + X3,
  data,
  path,
  time_method = list("ar", "date"),
  space_method = list("use_ssn", c("Exponential.taildown")),
  iter = 3000,
  warmup = 1500,
  chains = 3,
  refresh = 100,
  loglik = FALSE,
  ppd = TRUE,
  seed = 123,
  total_iter = 10
)
}
\arguments{
\item{formula}{A formula specifying the response and covariates, e.g., \code{yobs ~ X1 + X2 + X3}.}

\item{data}{A data frame with the full space-time dataset, including covariates and response.}

\item{path}{Path to the folder containing SSN or spatial network objects and distance matrices.}

\item{time_method}{A list specifying temporal structure, e.g., \code{list("ar", "date")}.}

\item{space_method}{A list specifying spatial covariance function and structure, e.g., \code{list("use_ssn", c("Exponential.taildown"))}.}

\item{iter}{Number of iterations per Stan run (default 3000).}

\item{warmup}{Number of warmup iterations (default 1500).}

\item{chains}{Number of Stan chains (default 3).}

\item{refresh}{Frequency of Stan progress printout (default 100).}

\item{loglik}{Logical, whether to return pointwise log-likelihood (default \code{FALSE}).}

\item{ppd}{Logical, whether to return posterior predictive distributions (default \code{TRUE}).}

\item{seed}{Random seed (default: 123).}

\item{total_iter}{Number of RMSE-based refinement iterations (default: 10).}
}
\value{
A list with elements:
\describe{
  \item{\code{fit}}{The final Stan model object.}
  \item{\code{pred}}{Data frame with posterior predictions, intervals, and anomaly indicators.}
  \item{\code{data_list}}{List of Stan inputs used for the final model.}
  \item{\code{replic}}{Matrix of knot selections across iterations.}
}
}
\description{
Fits a Bayesian spatio-temporal model with autoregressive temporal structure and stream-network-based spatial modeling using Stan. The method automatically selects spatial knots based on iterative RMSE performance and returns predictions with uncertainty and anomaly indicators.
}

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fits a mixed regression model using Stan — ssnbayes • SSNbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fits a mixed regression model using Stan — ssnbayes"><meta property="og:description" content="It requires the same number of observation/locations per day.
It requires location id (locID) and points id (pid).
The locID are unique for each site.
The pid is unique for each observation.
Missing values are allowed in the response but not in the covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SSNbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/SSNbayes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EdgarSantos-Fernandez/SSNbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits a mixed regression model using Stan</h1>
    <small class="dont-index">Source: <a href="https://github.com/EdgarSantos-Fernandez/SSNbayes/blob/HEAD/R/all_func.R" class="external-link"><code>R/all_func.R</code></a></small>
    <div class="hidden name"><code>ssnbayes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>It requires the same number of observation/locations per day.
It requires location id (locID) and points id (pid).
The locID are unique for each site.
The pid is unique for each observation.
Missing values are allowed in the response but not in the covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ssnbayes</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  path <span class="op">=</span> <span class="va">path</span>,</span>
<span>  time_method <span class="op">=</span> <span class="va">time_method</span>,</span>
<span>  space_method <span class="op">=</span> <span class="va">space_method</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">iter</span><span class="op">/</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  addfunccol <span class="op">=</span> <span class="va">addfunccol</span>,</span>
<span>  loglik <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>A formula as in lm()</p></dd>


<dt>data</dt>
<dd><p>A long data frame containing the locations, dates, covariates and the response variable. It has to have the locID and date. No missing values are allowed in the covariates.</p></dd>


<dt>path</dt>
<dd><p>Path with the name of the SSN object</p></dd>


<dt>time_method</dt>
<dd><p>A list specifying the temporal structure (ar = Autorregressive; var = Vector autorregression) and coumn in the data with the time variable.</p></dd>


<dt>space_method</dt>
<dd><p>A list defining if use or not of an SSN object and the spatial correlation structure. The second element is the spatial covariance structure. A 3rd element is a list with the lon and lat for Euclidean distance models.</p></dd>


<dt>iter</dt>
<dd><p>Number of iterations</p></dd>


<dt>warmup</dt>
<dd><p>Warm up samples</p></dd>


<dt>chains</dt>
<dd><p>Number of chains</p></dd>


<dt>refresh</dt>
<dd><p>Sampler refreshing rate</p></dd>


<dt>net</dt>
<dd><p>The network id (optional). Used when the SSN object cotains multiple networks.</p></dd>


<dt>addfunccol</dt>
<dd><p>Variable to compute the additive function. Used to compute the spatial weights.</p></dd>


<dt>loglik</dt>
<dd><p>Logic parameter denoting if the loglik will be computed by the model.</p></dd>


<dt>seed</dt>
<dd><p>(optional) A seed for reproducibility</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the model fit</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Missing values are not allowed in the covariates and they must be imputed before using ssnbayes(). Many options can be found in https://cran.r-project.org/web/views/MissingData.html</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edgar Santos-Fernandez</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#options(mc.cores = parallel::detectCores())</span></span></span>
<span class="r-in"><span><span class="co"># Import SpatialStreamNetwork object</span></span></span>
<span class="r-in"><span><span class="co">#path &lt;- system.file("extdata/clearwater.ssn", package = "SSNbayes")</span></span></span>
<span class="r-in"><span><span class="co">#n &lt;- importSSN(path, predpts = "preds", o.write = TRUE)</span></span></span>
<span class="r-in"><span><span class="co">## Imports a data.frame containing observations and covariates</span></span></span>
<span class="r-in"><span><span class="co">#clear &lt;- readRDS(system.file("extdata/clear_obs.RDS", package = "SSNbayes"))</span></span></span>
<span class="r-in"><span><span class="co">#fit_ar &lt;- ssnbayes(formula = y ~ SLOPE + elev + h2o_area + air_temp + sin + cos,</span></span></span>
<span class="r-in"><span><span class="co">#                   data = clear,</span></span></span>
<span class="r-in"><span><span class="co">#                   path = path,</span></span></span>
<span class="r-in"><span><span class="co">#                   time_method = list("ar", "date"),</span></span></span>
<span class="r-in"><span><span class="co">#                   space_method = list('use_ssn', c("Exponential.taildown")),</span></span></span>
<span class="r-in"><span><span class="co">#                   iter = 2000,</span></span></span>
<span class="r-in"><span><span class="co">#                   warmup = 1000,</span></span></span>
<span class="r-in"><span><span class="co">#                   chains = 3,</span></span></span>
<span class="r-in"><span><span class="co">#                   net = 2, # second network on the ssn object</span></span></span>
<span class="r-in"><span><span class="co">#                   addfunccol='afvArea')</span></span></span>
<span class="r-in"><span><span class="co">#space_method options examples</span></span></span>
<span class="r-in"><span><span class="co">#use list('no_ssn', 'Exponential.Euclid', c('lon', 'lat')) if no ssn object is available</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edgar Santos-Fernandez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

